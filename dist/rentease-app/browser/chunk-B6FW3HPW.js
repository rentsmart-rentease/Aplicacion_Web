import{a as l}from"./chunk-KNREYW3N.js";import{a as p}from"./chunk-ZWI4LHCU.js";import{V as s,Z as n,ca as a}from"./chunk-CO3NRWUX.js";var x=(()=>{let e=class e{constructor(t){this.http=t,this.baseUrl=l.apiUrl,this.storageKey="isLoggedIn",this.responseKey="loginResponse",this.expirationKey="loginResponseExpiration",this.initExpirationTimer()}login(t){return this.http.post(`${this.baseUrl}/login`,t).pipe(s(i=>{let o=new Date;o.setHours(o.getHours()+1),localStorage.setItem(this.storageKey,"true"),localStorage.setItem(this.responseKey,JSON.stringify(i)),localStorage.setItem(this.expirationKey,o.getTime().toString()),this.initExpirationTimer()}))}isLoggedIn(){let t=localStorage.getItem(this.storageKey)==="true",i=localStorage.getItem(this.expirationKey);return t&&i?parseInt(i,10)>Date.now():!1}getLoginResponse(){if(this.isLoggedIn()){let t=localStorage.getItem(this.responseKey);return t?JSON.parse(t):null}return null}logout(){localStorage.removeItem(this.storageKey),localStorage.removeItem(this.responseKey),localStorage.removeItem(this.expirationKey),this.clearExpirationTimer()}initExpirationTimer(){this.clearExpirationTimer();let t=localStorage.getItem(this.expirationKey);if(t){let o=parseInt(t,10)-Date.now();o>0&&(this.expirationTimer=setTimeout(()=>{this.logout()},o))}}clearExpirationTimer(){this.expirationTimer&&(clearTimeout(this.expirationTimer),this.expirationTimer=null)}};e.\u0275fac=function(i){return new(i||e)(a(p))},e.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();export{x as a};
